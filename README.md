# fastify-app

> Opinionated feature pack (of packages) to bootstrap a fastify app

## Features

* decorates your app with __`name`__, __`version`__ and __`root`__-path read from package.json
* decorates your app with any given __`config`__
* provides __OpenAPI 3.0__ docs by use of [fastify-oas](https://github.com/SkeLLLa/fastify-oas)
* enables extra __security__ headers as provided by __helmet__ [fastify-helmet](https://github.com/fastify/fastify-helmet)
* provides extra __sensible defaults__ provided by [fastify-sensible](https://github.com/fastify/fastify-sensible)
* uses [fastify-autoload](https://github.com/fastify/fastify-autoload) to __load plugins, models, services, whatever__ from configurable directories
* provides __monitoring healthcheck__ endpoint by use of [under-pressure](https://github.com/fastify/under-pressure)

All those features are ready setup with defaults, that may be customized further to your likings.

## Get Started (cli)

Easy start by `yarn create` cli command to create a new fastify-app from scratch instead of manually setting up a new fastify instance, like so:

```bash
$ yarn create @uscreen.de/fastify-app new-app
```

and follow instructions. It will create a directory called `new-app` inside the current folder.
Inside that directory, it will generate the initial project structure and install any dependencies:

```bash
new-app
├── Makefile
├── README.md
├── app
│   ├── app.js
│   ├── config.js
│   ├── plugins
│   │   └── noop.js
│   ├── schemas.js
│   ├── server.js
│   └── services
│       └── noop.js
├── package.json
├── pm2-dev.config.js
├── pm2.config.js
├── test
│   ├── helper.js
│   └── noop.test.js
└── yarn.lock
```

---

## Install (manual)

```sh
$ yarn add @uscreen.de/fastify-app # or use npm -i
```

## Example (manual)

```js
// require @uscreen.de/fastify-app
const defaultApp = require('@uscreen.de/fastify-app')

// register with defaults
fastify.register(defaultApp)
```

This enables all default features and exposes some extra routes, like:

* `GET /documentation` - autogenerated OpenAPI 3.0 documentation of all endpoint
* `GET /status` - healthcheck endpoint return HTTP 200 `{"status":"ok"}`

---

## Options

All options get validated and defaulted to a defined json-schema you can check in [config.js](./config.js) Overview of options:

| option          | Description                                                                                                                                                                                                                                                                               | Default                     | Example                          |
|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|----------------------------------|
| __autoloads__   | array of directories [fastify-autoload](https://github.com/fastify/fastify-autoload) should load your fastify plugins from. Please consider reading [Loading order of your plugins](https://github.com/fastify/fastify/blob/master/docs/Getting-Started.md#loading-order-of-your-plugins) | `[]`                        | `['./plugins', './services']`    |
| __swagger__     | object configuring [fastify-oas](https://github.com/SkeLLLa/fastify-oas) to generate OpenAPI 3.0 docs from your routes                                                                                                                                                                    | `{exposeRoute: true}`       | `{exposeRoute: '/docs'}`         |
| __healthCheck__ | object configuring [under-pressure](https://github.com/fastify/under-pressure) to provide a monitoring healthcheck route for your app                                                                                                                                                     | `{exposeStatusRoute: true}` | `{exposeStatusRoute: '/health'}` |


## Roadmap

- add a generic command cli

## Changelog

### 0.3.0

- moved cli to separate package `@uscreen.de/create-fastify-app`

### 0.2.0

- added cli

### 0.1.0

- added tests (100% coverage)

### 0.0.0

- project setup, linting, guidlines

---

## License

Licensed under [MIT](./LICENSE).

Published, Supported and Sponsored by [u|screen](https://uscreen.de)
